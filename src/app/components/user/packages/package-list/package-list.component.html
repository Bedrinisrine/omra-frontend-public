<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Packages</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="main-navbar">
      <div class="navbar-logo">
        <img src="assets/images/omralogo.jpg" alt="MYOMRA Logo" />
        <span>MYOMRA</span>
      </div>
      <ul class="navbar-menu">
        <li><a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Accueil</a></li>
        <li><a href="#">À propos</a></li>
        <li><a routerLink="/user/packages" routerLinkActive="active">Nos forfaits</a></li>
        <li><a routerLink="/user/hotels" routerLinkActive="active">Hôtels</a></li>
        <li><a href="#">Découvrir</a></li>
        <li><a href="#">Concevez votre Omra</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>

    <div class="hero-section">
      <h1 class="hero-title">Pakage</h1>
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar-container">
      <div class="filter-bar-modern">
        <div class="filter-tabs-modern">
          <button class="tab-button-modern" [class.active]="selectedTab === 'package'" (click)="setTab('package')">
            <i class="fas fa-box"></i> Forfait
          </button>
          <button class="tab-button-modern" [class.active]="selectedTab === 'hotel'" (click)="setTab('hotel')">
            <i class="fas fa-hotel"></i> Hôtels
          </button>
          <button class="tab-button-modern" [class.active]="selectedTab === 'flight'" (click)="setTab('flight')">
            <i class="fas fa-plane"></i> Vols
          </button>
        </div>
        <div class="filter-inputs-modern">
          <!-- Vols Tab -->
          <ng-container *ngIf="selectedTab === 'flight'">
            <div class="input-group-modern">
              <label for="flightFrom">Départ</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-map-marker-alt"></i>
                <select id="flightFrom" [(ngModel)]="flightFrom">
                  <option value="" disabled selected>Ville de départ</option>
                  <option value="Paris, France">Paris, France</option>
                  <option value="Marseille, France">Marseille, France</option>
                  <option value="Lyon, France">Lyon, France</option>
                  <option value="Bruxelles, Belgique">Bruxelles, Belgique</option>
                  <option value="Genève, Suisse">Genève, Suisse</option>
                </select>
              </div>
            </div>
            <div class="input-group-modern">
              <label for="flightTo">À</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-map-marker-alt"></i>
                <select id="flightTo" [(ngModel)]="flightTo">
                  <option value="" disabled selected>Ville d'arrivée</option>
                  <option value="Makkah">Makkah</option>
                  <option value="Madinah">Madinah</option>
                </select>
              </div>
            </div>
            <div class="input-group-modern">
              <label for="flightDate">Date</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-calendar-alt"></i>
                <input type="date" id="flightDate" [(ngModel)]="flightDate">
              </div>
            </div>
          </ng-container>
          <!-- Hôtels Tab -->
          <ng-container *ngIf="selectedTab === 'hotel'">
            <div class="input-group-modern">
              <label for="hotelCity">Ville</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-map-marker-alt"></i>
                <select id="hotelCity" [(ngModel)]="hotelCity" style="flex: 1; border: none; background: transparent; font-size: 1rem; outline: none; padding: 0; color: #222;">
                <option value="Makkah">La Mecque</option>
                <option value="Madinah">Médine</option>
              </select>
               </div>
            </div>
            <div class="input-group-modern">
              <label for="hotelDate">Date</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-calendar-alt"></i>
              <input type="date" id="hotelDate" [(ngModel)]="hotelDate">
              </div>
            </div>
          </ng-container>
          <!-- Forfait Tab -->
          <ng-container *ngIf="selectedTab === 'package'">
            <div class="input-group-modern">
              <label for="packageDeparture">Départ</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-map-marker-alt"></i>
                <select id="packageDeparture" [(ngModel)]="packageDeparture" style="flex: 1; border: none; background: transparent; font-size: 1rem; outline: none; padding: 0; color: #222;">
                  <option value="Paris, France">Paris, France</option>
                  <option value="Marseille, France">Marseille, France</option>
                  <option value="Lyon, France">Lyon, France</option>
                  <option value="Bruxelles, Belgique">Bruxelles, Belgique</option>
                  <option value="Genève, Suisse">Genève, Suisse</option>
                </select>
              </div>
            </div>
            <div class="input-group-modern">
              <label for="packageDate">Date</label>
              <div class="input-icon-wrapper">
                <i class="fas fa-calendar-alt"></i>
              <input type="date" id="packageDate" [(ngModel)]="packageDate">
              </div>
            </div>
          </ng-container>
          <button class="btn-search-modern" (click)="performSearch()"><i class="fas fa-search"></i> Rechercher</button>
        </div>
      </div>
    </div>

    <!-- Omra Filters -->
    <div class="omra-filters-container" *ngIf="selectedTab === 'package'">
      <div class="omra-filters">
        <button class="omra-filter-button" [class.active]="selectedOmraFilter === 'omraAgu2025'" (click)="setOmraFilter('omraAgu2025')">Omra Agu 2025</button>
        <button class="omra-filter-button" [class.active]="selectedOmraFilter === 'omraSep2025'" (click)="setOmraFilter('omraSep2025')">Omra Sep 2025</button>
        <button class="omra-filter-button ramadan" [class.active]="selectedOmraFilter === 'omraRamadan2025'" (click)="setOmraFilter('omraRamadan2025')"><i class="fas fa-moon"></i> Omra Ramadan 2025</button>
      </div>
    </div>

<div class="package-list-container">
  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <div *ngIf="loading" class="loading">
    Loading packages...
  </div>

      <div class="package-list" *ngIf="!loading && filteredPackages.length > 0">
        <div *ngFor="let package of filteredPackages" class="package-item">
          <div class="package-image-container">
      <img [src]="package.images && package.images[0] ? getImageUrl(package.images[0].image) : '/assets/images/kaaba.jpg'" 
           [alt]="package.nom_pak" 
                 class="package-item-image">
          </div>
          <div class="package-details-list">
            <div class="package-header">
        <h3>{{ package.nom_pak }}</h3>
            </div>
            
            <!-- Dynamic Status Badge -->
            <div *ngIf="package.status !== 'available'" 
                 class="status-badge"
                 [ngClass]="{
                   'limited': package.status === 'limited',
                   'last-places': package.status === 'last_places',
                   'sold-out': package.status === 'sold_out'
                 }">
              {{ package.statusText }}
            </div>
            
            <div class="package-meta">
              <p><i class="far fa-calendar-alt"></i> {{ package.date_debut | date: 'd MMM y' }} To {{ package.date_fin | date: 'd MMM y' }}</p>
              <p *ngIf="package.adr_hotel_medine"><i class="fas fa-hotel"></i> Medina: {{ package.adr_hotel_medine }} ({{ package.nbr_jrs_medine }} nights)</p>
              <p *ngIf="package.adr_hotel_mekka"><i class="fas fa-hotel"></i> Makkah: {{ package.adr_hotel_mekka }} ({{ package.nbr_jrs_mekka }} nights)</p>
              <p *ngIf="package.agence" style="display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-building"></i> 
                <span *ngIf="package.agence.logo_agence" style="display: flex; align-items: center; gap: 4px;">
                  <img [src]="getImageUrl(package.agence.logo_agence)" 
                       [alt]="package.agence.nomagence" 
                       style="width: 20px; height: 20px; object-fit: contain; border-radius: 2px;">
                  {{ package.agence.nomagence }}
                </span>
                <span *ngIf="!package.agence.logo_agence">
                  {{ package.agence.nomagence }}
                </span>
              </p>
              <p><i class="fas fa-users"></i> Places disponibles: {{ package.qte_package }}</p>
            </div>

            <!-- Added a basic pricing section -->
            <div class="package-price-list">
                <span class="price">{{ package.prix }} € $</span>
            </div>
            
            <div class="package-actions">
              <button class="btn-reservation" 
                      [disabled]="package.status === 'sold_out'"
                      [ngStyle]="{
                        'opacity': package.status === 'sold_out' ? '0.5' : '1',
                        'cursor': package.status === 'sold_out' ? 'not-allowed' : 'pointer'
                      }">
                {{ package.status === 'sold_out' ? 'Épuisé' : 'Réservation' }}
              </button>
              <button class="btn-read-more" (click)="showPackageDetails(package)">Read More <i class="fas fa-chevron-right"></i></button>
            </div>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && packages.length === 0" class="no-packages">
    No packages available at the moment.
  </div>
</div> 

    <!-- Footer -->
    <footer class="main-footer">
      <div class="footer-content">
        <div class="footer-section about">
          <div class="footer-logo">
            <img src="assets/images/omralogo.jpg" alt="MYOMRA Logo" />
            <span>MYOMRA</span>
          </div>
          <p>Votre partenaire de confiance pour une Omra sans faille</p>
          <p>Nous nous engageons à rendre votre voyage spirituel aussi fluide et significatif que possible. Forts de plusieurs années d'expérience et d'une compréhension approfondie des besoins des pèlerins.</p>
           <button class="language-switcher">
              <i class="fas fa-globe"></i> Français
            </button>
        </div>

        <div class="footer-section links">
          <h4>Liens rapides</h4>
          <ul>
            <li><a href="#">Accueil</a></li>
            <li><a href="#">À propos</a></li>
            <li><a href="#">Nos forfaits</a></li>
          </ul>
        </div>

        <div class="footer-section pages">
          <h4>Pages</h4>
          <ul>
            <li><a href="#">Découvrir</a></li>
            <li><a href="#">Concevez votre Omra</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </div>

        <div class="footer-section payment">
          <h4>Moyens de paiement</h4>
          <div class="payment-icons">
            <img src="assets/images/visalogo.png" alt="Visa">
            <img src="assets/images/mastercardlogo.png" alt="Mastercard">
            <img src="assets/images/paypallogo.png" alt="PayPal">
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <p>&copy; 2024 MY Omra. Tous droits réservés.</p>
        <div class="footer-social">
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-youtube"></i></a>
        </div>
      </div>
    </footer>

</body>
</html> 